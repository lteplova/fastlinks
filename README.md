# API-сервис сокращения ссылок fastlink

## Функционал сервиса
Скринкаст:

### Установка сервиса 

сервис состоит из файлов:  
`bot.py` - файл для запуска приложения  
`config.py` - конфигурационный файл, содержит необходимые токены для подключения к API  
`handlers.py` - содержит все функции, которые реализует бот  
`norms.py` - вспомогательные функции для расчета норм  
`plot_graph.py` - вспомогательные функции для построения графиков  
`сalories_activity.py` - вспомогательные функции для расчета каллорий и подключению к API  
`states.py`  - вспомогательный файл с состояниями  

установка:  
docker-compose up --build

### Структура проекта:
fastlinks/
```
│── .env                        # переменные окружения (пароли/пути)
│── .gitignore                  # игнорируемые файлы для Git
│── alembic.ini                 # конфигурация Alembic для миграций
│── cache.py                    # функции для работы с кэшем (Redis)
│── config.py                   # конфигурации, подгружаются из  .env
│── docker-compose.yml          # файл для управления контейнерами
│── Dockerfile                  # файл для создания образа Docker
│── main.py                     # запуск приложения
│── requirements.txt            # зависимости
│── migrations/                 # миграции Alembic
│   ├── versions/               # версии миграций
│── models/                     
│   ├── models.py               # инициализация моделей
│── routers/                    
│   ├── auth_routes.py          # эндпоинты для аутентификации
│   ├── links.py                # эндпоинты для управления ссылками
│── services.py                 # вспомогательные функции для реализации работы эндпоинтов
│── auth/                       
│   ├── db.py                   # подключение к базе данных
│   ├── schemas.py              # pydantic схемы для валидации данных
│   ├── users.py                # аутентикация пользователей
```
### Окружение
- python 3.9  
- PostgreSQL17  
- Redis  7.2.7
- FasAPI
- sqlalchemy  
- Alembic
- Pydantic


### Доступные эндпоинты:  

Эндпоинты аутентификации (Auth) (стандартные из библиотеки `fastapi-users`)
```
    POST /auth/jwt/login: Выполняет аутентификацию пользователя и выдает JWT токен.
    POST /auth/jwt/logout: Завершает сеанс пользователя и аннулирует JWT токен.
    POST /auth/register: Регистрирует нового пользователя.
    POST /auth/forgot-password: Запрашивает сброс пароля.
    POST /auth/reset-password: Сбрасывает пароль пользователя.
    POST /auth/request-verify-token: Запрашивает токен для верификации.
    POST /auth/verify: Верифицирует пользователя по токену.
```
Эндпоинты для проверки аутентифицирован ли пользователь (default) 
```
    GET /protected-route: Возвращает имя авторизованного пользователя.
    GET /unprotected-route: Доступен для всех пользователей
```
Эндпоинты управления ссылками (Links)
```
    POST /links/shorten: Создает короткую ссылку для оригинального URL
    GET /links/{short_code}: Перенаправляет на оригинальный URL по указанной короткой ссылке
    DELETE /links/{short_code}: Удаляет короткую ссылку
    PUT /links/{short_code}: Обновляет существующую короткую ссылку. Этот эндпоинт генерирует новую короткую ссылку для оригинального URL
    GET /links/{short_code}/stats: Показывает сколько раз кликали на короткую ссылку и время последнего клика
    POST /links/shorten/custom: Позволяет задать кастомный алиас для ссылки и изменить время жизни существующей ссылки
    GET /links/search: Ищет короткую ссылку по указанному оригинальному URL
````

